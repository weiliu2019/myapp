(function(e){function t(t){for(var o,n,r=t[0],s=t[1],c=t[2],m=0,u=[];m<r.length;m++)n=r[m],Object.prototype.hasOwnProperty.call(a,n)&&a[n]&&u.push(a[n][0]),a[n]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);p&&p(t);while(u.length)u.shift()();return l.push.apply(l,c||[]),i()}function i(){for(var e,t=0;t<l.length;t++){for(var i=l[t],o=!0,r=1;r<i.length;r++){var s=i[r];0!==a[s]&&(o=!1)}o&&(l.splice(t--,1),e=n(n.s=i[0]))}return e}var o={},a={follow:0},l=[];function n(t){if(o[t])return o[t].exports;var i=o[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=o,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],s=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var p=s;l.push([13,"chunk-vendors","chunk-common"]),i()})({13:function(e,t,i){e.exports=i("44b6")},"44b6":function(e,t,i){"use strict";i.r(t);i("cadf"),i("551c"),i("f751"),i("097d");var o=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("page",{ref:"page",staticClass:"follow-page common-page",attrs:{headerHeightVW:e.headerHeightVW,scrollbar:""},on:{"on-ready":e.onReady,"on-show":e.onShow}},[o("van-nav-bar",{attrs:{slot:"header",id:"header",title:"问题跟进","left-arrow":""},on:{"click-left":e.onClickLeft},slot:"header"}),o("van-cell-group",[o("van-cell",{attrs:{title:"问题编号："}},[e._v(e._s(e.problemDetail&&e.problemDetail.no))])],1),o("van-cell-group",[o("van-cell",{attrs:{title:"发生时间："}},[e._v(e._s(e.problemDetail&&e.problemDetail.time))]),o("van-cell",{attrs:{title:"故障地点","is-link":"",clickable:""},on:{click:e.handleSelectLine}},[o("span",[e._v(e._s(e.line&&e.line.name)+" / "+e._s(e.station&&e.station.name))])]),o("van-field",{attrs:{placeholder:"请输入详细地址",type:"textarea",rows:2,autosize:""},model:{value:e.problemDetail.address,callback:function(t){e.$set(e.problemDetail,"address",t)},expression:"problemDetail.address"}}),o("van-cell",{attrs:{title:"问题来源","is-link":"",clickable:""},on:{click:e.handleSelectSource}},[o("span",[e._v(e._s(e.source&&e.source.name))])]),o("van-cell",{attrs:{title:"所属专业","is-link":"",clickable:""},on:{click:e.handleSelectProfession}},[o("span",[e._v(e._s(e.profession&&e.profession.name))])]),o("van-cell",{attrs:{title:"故障设备分类","is-link":"",clickable:""},on:{click:e.handleSelectDeviceCategory}},[o("span",[e._v(e._s(e.deviceCategory&&e.deviceCategory.name))])]),o("van-field",{attrs:{label:"车组号：",placeholder:"请填写车组号"},model:{value:e.problemDetail.carNo,callback:function(t){e.$set(e.problemDetail,"carNo",t)},expression:"problemDetail.carNo"}})],1),o("van-cell-group",[o("van-cell",{staticClass:"detail-title ",attrs:{title:"问题摘要："}}),o("van-field",{attrs:{placeholder:"请填写问题摘要",type:"textarea",rows:2,autosize:""},model:{value:e.problemDetail.summary,callback:function(t){e.$set(e.problemDetail,"summary",t)},expression:"problemDetail.summary"}})],1),o("van-cell-group",[o("van-cell",{staticClass:"detail-title ",attrs:{title:"问题简述："}}),o("van-field",{attrs:{placeholder:"请填写问题简述",type:"textarea",rows:2,autosize:""},model:{value:e.problemDetail.problemDesc,callback:function(t){e.$set(e.problemDetail,"problemDesc",t)},expression:"problemDetail.problemDesc"}})],1),o("van-cell-group",[o("van-cell",{staticClass:"detail-title ",attrs:{title:"现象描述："}}),o("van-field",{attrs:{placeholder:"请填写现象描述",type:"textarea",rows:2,autosize:""},model:{value:e.problemDetail.description,callback:function(t){e.$set(e.problemDetail,"description",t)},expression:"problemDetail.description"}})],1),o("van-cell-group",[o("van-cell",{staticClass:"required",attrs:{title:"问题分类","is-link":"",clickable:""},on:{click:e.handleSelectCategory}},[o("span",[e._v(e._s(e.category&&e.category.name||"请选择"))])]),o("van-cell",{staticClass:"required",attrs:{title:"问题等级","is-link":"",clickable:""},on:{click:e.handleSelectLevel}},[o("span",[e._v(e._s(e.level&&e.level.name||"请选择"))])]),o("van-cell",{attrs:{title:"承包商","is-link":"",clickable:""},on:{click:e.handleSelectContractor}},[o("span",[e._v(e._s(e.problemDetail.contractor&&e.problemDetail.contractor.id?e.problemDetail.contractor.name:"请选择"))])]),o("van-cell",{attrs:{title:"通知承包商时间","is-link":"",clickable:""},on:{click:e.handleSelectNoticeTime}},[o("span",[e._v(e._s(e.noticeTime?e.noticeTime:"请选择"))])]),o("van-cell",{attrs:{title:"承包商答复时间","is-link":"",clickable:""},on:{click:e.handleSelectReplyTime}},[o("span",[e._v(e._s(e.replyTime?e.replyTime:"请选择"))])]),o("van-cell",{attrs:{title:"承包商开始工作时间","is-link":"",clickable:""},on:{click:e.handleSelectBeginTime}},[o("span",[e._v(e._s(e.beginTime?e.beginTime:"请选择"))])]),o("van-cell",{attrs:{title:"承包商完成工作时间","is-link":"",clickable:""},on:{click:e.handleSelectFinishTime}},[o("span",[e._v(e._s(e.finishTime?e.finishTime:"请选择"))])]),o("van-field",{attrs:{label:"非维修时间：",placeholder:"请输入非维修时间"},model:{value:e.noRepairTime,callback:function(t){e.noRepairTime=t},expression:"noRepairTime"}}),o("van-cell",{attrs:{title:"故障修复时间","is-link":"",clickable:""},on:{click:e.handleSelectRepairTime}},[o("span",[e._v(e._s(e.repairTime?e.repairTime:"请选择"))])])],1),o("van-cell-group",[o("van-cell",{staticClass:"detail-title required",attrs:{title:"初步原因分析："}}),o("van-field",{attrs:{placeholder:"请填写原因",type:"textarea",rows:2,autosize:""},model:{value:e.problemDetail.analysis,callback:function(t){e.$set(e.problemDetail,"analysis",t)},expression:"problemDetail.analysis"}})],1),o("van-cell-group",[o("van-cell",{staticClass:"detail-title required",attrs:{title:"初步解决方案："}}),o("van-field",{attrs:{placeholder:"请填写方案",type:"textarea",rows:2,autosize:""},model:{value:e.problemDetail.beginSolutions,callback:function(t){e.$set(e.problemDetail,"beginSolutions",t)},expression:"problemDetail.beginSolutions"}})],1),o("van-cell-group",[o("van-cell",{staticClass:"detail-title required",attrs:{title:"最终解决方案："}}),o("van-field",{attrs:{placeholder:"请填写方案",type:"textarea",rows:2,autosize:""},model:{value:e.problemDetail.finishSolutions,callback:function(t){e.$set(e.problemDetail,"finishSolutions",t)},expression:"problemDetail.finishSolutions"}})],1),o("van-cell-group",[o("van-cell",{staticClass:"detail-title",attrs:{title:"备注："}}),o("van-field",{attrs:{placeholder:"",type:"textarea",rows:2,autosize:""},model:{value:e.problemDetail.remark,callback:function(t){e.$set(e.problemDetail,"remark",t)},expression:"problemDetail.remark"}})],1),o("van-cell-group",[o("van-cell",{staticClass:"detail-title",attrs:{title:"图像："}}),o("div",{staticClass:"images-container"},[e._l(e.imageList,(function(t,i){return o("div",{key:i,staticClass:"image-item-show",on:{click:function(t){return e.handlePlayImages(i)}}},[o("auto-image",{staticStyle:{"margin-bottom":"12px","margin-left":"12px"},attrs:{src:t.url,width:108,height:108}}),o("div",{staticClass:"image-remove",on:{click:function(t){return t.stopPropagation(),e.handleImageRemove(i)}}})],1)})),o("div",{staticClass:"image-item",staticStyle:{background:"#fff"},on:{click:function(t){return t.stopPropagation(),e.handlePhoto1(t)}}},[o("img",{attrs:{src:i("4857")}})])],2)],1),o("van-cell-group",[o("van-cell",{staticClass:"detail-title",attrs:{title:"视频："}}),o("div",{staticClass:"images-container"},[e._l(e.videoList,(function(t,a){return o("div",{key:a,staticClass:"image-item-show",on:{click:function(i){return e.handlePlayVideo(t)}}},[o("img",{staticClass:"img-video",attrs:{src:i("f0f8")}}),o("div",{staticClass:"image-remove",on:{click:function(t){return t.stopPropagation(),e.handleVideoRemove(a)}}})])})),o("div",{staticClass:"image-item",staticStyle:{background:"#fff"},on:{click:function(t){return t.stopPropagation(),e.handlePhoto2(t)}}},[o("img",{attrs:{src:i("4857")}})])],2)],1),o("div",{staticClass:"blank-empty"}),o("template",{slot:"blank"},[o("div",{staticClass:"footer-action"},[o("div",{staticClass:"action-item",on:{click:e.handleCancel}},[o("i",{staticClass:"action-item-icon icon-xiaoxiang"}),o("span",[e._v("取消")])]),o("van-button",{staticClass:"action-item-main btn-save",attrs:{color:"rgba(16, 142, 233, 0.15)"},on:{click:e.handleSave}},[e._v("保存")]),o("van-button",{staticClass:"action-item-main",attrs:{color:"#108EE9"},on:{click:e.handleSubmit}},[e._v("提交审核")])],1),o("van-popup",{staticClass:"filter-popup",attrs:{position:"bottom","lock-scroll":!1,closeable:"","close-icon":"close",round:""},model:{value:e.levelShow,callback:function(t){e.levelShow=t},expression:"levelShow"}},[o("div",{staticClass:"title"},[e._v("\n        选择问题等级\n      ")]),e.levelShow?o("a-scroll",{ref:"filterScroller",staticClass:"filter-scroll"},[o("van-radio-group",{model:{value:e.levelRadio.id,callback:function(t){e.$set(e.levelRadio,"id",t)},expression:"levelRadio.id"}},[o("van-cell-group",e._l(e.levelOptions,(function(t,i){return o("van-cell",{key:i,attrs:{title:t.name,label:t.description,clickable:""},on:{click:function(i){e.levelRadio=Object.assign({},t)}}},[o("van-radio",{attrs:{slot:"right-icon",name:t.id},slot:"right-icon"})],1)})),1)],1)],1):e._e(),o("div",{staticClass:"footer-action"},[o("van-button",{staticClass:"action-item-main",attrs:{color:"#108EE9"},on:{click:e.onLevelSelect}},[e._v("确定")])],1)],1),o("van-popup",{staticClass:"filter-popup",attrs:{position:"bottom","lock-scroll":!1,closeable:"","close-icon":"close",round:""},model:{value:e.contractorShow,callback:function(t){e.contractorShow=t},expression:"contractorShow"}},[o("div",{staticClass:"title"},[e._v("选择承包商")]),e.contractorShow?o("a-scroll",{ref:"filterScroller",staticClass:"filter-scroll"},[o("van-radio-group",{model:{value:e.contractorRadio.id,callback:function(t){e.$set(e.contractorRadio,"id",t)},expression:"contractorRadio.id"}},[o("van-cell-group",e._l(e.contractorOptions,(function(t,i){return o("van-cell",{key:i,attrs:{title:t.name,label:t.description,clickable:""},on:{click:function(i){e.contractorRadio=Object.assign({},t)}}},[o("van-radio",{attrs:{slot:"right-icon",name:t.id},slot:"right-icon"})],1)})),1)],1)],1):e._e(),o("div",{staticClass:"footer-action"},[o("van-button",{staticClass:"action-item-main",attrs:{color:"#108EE9"},on:{click:e.onContractorSelect}},[e._v("确定")])],1)],1),o("van-popup",{staticClass:"filter-popup",attrs:{position:"bottom","lock-scroll":!1,closeable:"","close-icon":"close",round:""},model:{value:e.categoryShow,callback:function(t){e.categoryShow=t},expression:"categoryShow"}},[o("div",{staticClass:"title"},[e._v("\n        选择问题分类\n      ")]),e.categoryShow?o("a-scroll",{ref:"filterScroller",staticClass:"filter-scroll"},[o("van-radio-group",{model:{value:e.categoryRadio.id,callback:function(t){e.$set(e.categoryRadio,"id",t)},expression:"categoryRadio.id"}},[o("van-cell-group",e._l(e.categoryOptions,(function(t,i){return o("van-cell",{key:i,attrs:{title:t.name,label:t.description,clickable:""},on:{click:function(i){e.categoryRadio=Object.assign({},t)}}},[o("van-radio",{attrs:{slot:"right-icon",name:t.id},slot:"right-icon"})],1)})),1)],1)],1):e._e(),o("div",{staticClass:"footer-action"},[o("van-button",{staticClass:"action-item-main",attrs:{color:"#108EE9"},on:{click:e.onCategorySelect}},[e._v("确定")])],1)],1),o("van-popup",{staticClass:"time-popup",attrs:{position:"bottom","lock-scroll":!1,round:""},model:{value:e.replyTimeShow,callback:function(t){e.replyTimeShow=t},expression:"replyTimeShow"}},[o("van-datetime-picker",{attrs:{type:"datetime"},on:{confirm:e.handleReplyTimeConfirm,cancel:function(t){e.replyTimeShow=!1}},model:{value:e.createTime,callback:function(t){e.createTime=t},expression:"createTime"}})],1),o("van-popup",{staticClass:"time-popup",attrs:{position:"bottom","lock-scroll":!1,round:""},model:{value:e.beginTimeShow,callback:function(t){e.beginTimeShow=t},expression:"beginTimeShow"}},[o("van-datetime-picker",{attrs:{type:"datetime"},on:{confirm:e.handleBeginTimeConfirm,cancel:function(t){e.beginTimeShow=!1}},model:{value:e.createTime,callback:function(t){e.createTime=t},expression:"createTime"}})],1),o("van-popup",{staticClass:"time-popup",attrs:{position:"bottom","lock-scroll":!1,round:""},model:{value:e.finishTimeShow,callback:function(t){e.finishTimeShow=t},expression:"finishTimeShow"}},[o("van-datetime-picker",{attrs:{type:"datetime"},on:{confirm:e.handleFinishTimeConfirm,cancel:function(t){e.finishTimeShow=!1}},model:{value:e.createTime,callback:function(t){e.createTime=t},expression:"createTime"}})],1),o("van-popup",{staticClass:"time-popup",attrs:{position:"bottom","lock-scroll":!1,round:""},model:{value:e.repairTimeShow,callback:function(t){e.repairTimeShow=t},expression:"repairTimeShow"}},[o("van-datetime-picker",{attrs:{type:"datetime"},on:{confirm:e.handleRepairTimeConfirm,cancel:function(t){e.repairTimeShow=!1}},model:{value:e.createTime,callback:function(t){e.createTime=t},expression:"createTime"}})],1),o("van-popup",{staticClass:"time-popup",attrs:{position:"bottom","lock-scroll":!1,round:""},model:{value:e.noticeTimeShow,callback:function(t){e.noticeTimeShow=t},expression:"noticeTimeShow"}},[o("van-datetime-picker",{attrs:{type:"datetime"},on:{confirm:e.handleNoticeTimeConfirm,cancel:function(t){e.noticeTimeShow=!1}},model:{value:e.createTime,callback:function(t){e.createTime=t},expression:"createTime"}})],1),o("van-popup",{staticClass:"filter-popup",attrs:{position:"bottom","lock-scroll":!1,closeable:"","close-icon":"close",round:""},model:{value:e.sourceShow,callback:function(t){e.sourceShow=t},expression:"sourceShow"}},[o("div",{staticClass:"title"},[e._v("选择问题来源")]),e.sourceShow?o("a-scroll",{ref:"filterScroller",staticClass:"filter-scroll"},[o("van-radio-group",{model:{value:e.sourceRadio.id,callback:function(t){e.$set(e.sourceRadio,"id",t)},expression:"sourceRadio.id"}},[o("van-cell-group",e._l(e.sourceOptions,(function(t,i){return o("van-cell",{key:i,attrs:{title:t.name,label:t.description,clickable:""},on:{click:function(i){e.sourceRadio=Object.assign({},t)}}},[o("van-radio",{attrs:{slot:"right-icon",name:t.id},slot:"right-icon"})],1)})),1)],1)],1):e._e(),o("div",{staticClass:"footer-action"},[o("van-button",{staticClass:"action-item-main",attrs:{color:"#108EE9"},on:{click:e.onSourceSelect}},[e._v("确定")])],1)],1),o("van-popup",{staticClass:"filter-popup",attrs:{position:"bottom","lock-scroll":!1,closeable:"","close-icon":"close",round:""},model:{value:e.professionShow,callback:function(t){e.professionShow=t},expression:"professionShow"}},[o("div",{staticClass:"title"},[e._v("选择所属专业")]),e.professionShow?o("a-scroll",{ref:"filterScroller",staticClass:"filter-scroll"},[o("van-radio-group",{model:{value:e.professionRadio.id,callback:function(t){e.$set(e.professionRadio,"id",t)},expression:"professionRadio.id"}},[o("van-cell-group",e._l(e.professionOptions,(function(t,i){return o("van-cell",{key:i,attrs:{title:t.name,label:t.description,clickable:""},on:{click:function(i){e.professionRadio=Object.assign({},t)}}},[o("van-radio",{attrs:{slot:"right-icon",name:t.id},slot:"right-icon"})],1)})),1)],1)],1):e._e(),o("div",{staticClass:"footer-action"},[o("van-button",{staticClass:"action-item-main",attrs:{color:"#108EE9"},on:{click:e.onProfessionSelect}},[e._v("确定")])],1)],1),o("van-dialog",{attrs:{"show-cancel-button":"","before-close":e.beforeClose},model:{value:e.editShow,callback:function(t){e.editShow=t},expression:"editShow"}},[o("van-cell",{attrs:{title:"描述"}}),o("van-field",{ref:"desInput",attrs:{type:"textarea",clearable:!0},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}})],1)],1)],2)},a=[],l=(i("1c01"),i("58b2"),i("8e6e"),i("f3e2"),i("d25f"),i("ac6a"),i("456d"),i("bd86")),n=i("9973"),r=i("4e1b"),s=i("c03e"),c=i("4ff5"),p=i("8149"),m=i("365c"),u=i("c1df"),d=i.n(u),h=i("0e5c"),f=i("698a");function v(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function b(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?v(Object(i),!0).forEach((function(t){Object(l["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):v(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var g={components:{Page:n["a"],AScroll:r["a"],AutoImage:c["a"]},data:function(){return{headerHeightVW:0,header:null,imageList:[],videoList:[],levelOptions:JSON.parse(localStorage.getItem("problem_level")),categoryOptions:JSON.parse(localStorage.getItem("problem_category")),contractorOptions:JSON.parse(localStorage.getItem("problem_contractor")),professionOptions:JSON.parse(localStorage.getItem("problem_profession")),sourceOptions:JSON.parse(localStorage.getItem("problem_source")),levelShow:!1,levelRadio:null,level:null,problemDetail:{},categoryShow:!1,categoryRadio:null,contractorShow:!1,contractorRadio:null,category:null,editShow:!1,description:"",flow:null,imgFile:null,imageFilter:null,videoCompression:null,replyTime:"",replyTimeShow:!1,createTime:new Date,beginTime:"",beginTimeShow:!1,finishTime:"",finishTimeShow:!1,repairTime:"",repairTimeShow:!1,noRepairTime:"",noticeTime:"",noticeTimeShow:!1,user:JSON.parse(localStorage.getItem("user")),line:null,station:null,sourceShow:!1,sourceRadio:null,source:null,deviceCategory:null,professionShow:!1,professionRadio:null,profession:null}},methods:{onReady:function(e,t){this.header=e,this.headerHeightVW=100*(this.header.h+1)/this.header.w,this.id=s["a"].getParam("id"),localStorage.setItem("address_select",""),localStorage.setItem("category_select",""),this.loadProblem()},onShow:function(){if(localStorage.getItem("address_select")){var e=JSON.parse(localStorage.getItem("address_select"));this.line=e[0],this.station=e[e.length-1]}if(localStorage.getItem("category_select")){var t=JSON.parse(localStorage.getItem("category_select"));this.deviceCategory=t[t.length-1]}},loadProblem:function(){var e=this;this.$toast.loading({duration:0,loadingType:"spinner"}),m["a"].getProblemDetail({id:this.id}).then((function(t){p["a"].getProblemDetail(e.id).then((function(i){e.problemDetail=b({},t,{},i),e.level=e.problemDetail.level,e.category=e.problemDetail.category,e.flow=e.problemDetail.processflow,e.line=e.problemDetail.line,e.station=e.problemDetail.station,e.source=e.problemDetail.source,e.profession=e.problemDetail.profession,e.deviceCategory=e.problemDetail.deviceCategory,e.imageList=e.problemDetail.images||[],e.videoList=e.problemDetail.videos||[],e.replyTime=e.problemDetail.contractorReplyTime,e.beginTime=e.problemDetail.contractorBeginTime,e.finishTime=e.problemDetail.contractorFinishTime,e.repairTime=e.problemDetail.repairFinishTime,e.noticeTime=e.problemDetail.contractorNoticeTime,e.noRepairTime=e.problemDetail.noRepairTime,e.$toast.clear()}))})).catch((function(t){e.$toast(t)}))},handleSelectLevel:function(){this.levelShow=!0,this.levelRadio=b({},this.level)},handleSelectCategory:function(){this.categoryShow=!0,this.categoryRadio=b({},this.category)},onLevelSelect:function(){this.level=b({},this.levelRadio),this.levelShow=!1},onCategorySelect:function(){this.category=b({},this.categoryRadio),this.categoryShow=!1},onClickLeft:function(){s["a"].back()},handlePhoto1:function(){var e=this;api.actionSheet({buttons:["打开照相机","从相册获取"]},(function(t,i){var o=t.buttonIndex,a="";1===o?a="camera":2===o&&(a="album"),a&&api.getPicture({sourceType:a,destinationType:"url",preview:!0,quality:50,mediaValue:"pic"},(function(t,i){t.data&&(e.imgFile=t.data,e.description="",e.editShow=!0,setTimeout((function(){e.$refs.desInput.focus()}),200))}))}))},handlePhoto2:function(){var e=this;api.actionSheet({buttons:["打开照相机","从相册获取"]},(function(t,i){var o=t.buttonIndex,a="";1===o?a="camera":2===o&&(a="album"),a&&api.getPicture({sourceType:a,destinationType:"url",preview:!0,quality:100,mediaValue:"video",saveToPhotoAlbum:!0,videoQuality:"high"},(function(t,i){t.data&&("ios"==api.systemType?(e.$toast.loading({duration:0,forbidClick:!0,loadingType:"spinner",message:"正在压缩..."}),e.videoCompression||(e.videoCompression=api.require("videoCompression")),e.videoCompression.compression({path:t.data,quality:"medium"},(function(t,i){"completed"==t.eventType&&(e.videoList.push({url:t.path}),e.$toast.clear())}))):e.videoList.push({url:t.data}))}))}))},handleVideoRemove:function(e){this.videoList.splice(e,1)},handleImageRemove:function(e){this.imageList.splice(e,1)},handlePlayVideo:function(e){api.openVideo({url:e.url})},handlePlayImages:function(e){localStorage.setItem("photos",JSON.stringify(this.imageList)),s["a"].open("photoViewer",{index:e})},handleReplyTimeConfirm:function(e){this.replyTime=d()(e).format("YYYY-MM-DD HH:mm"),this.replyTimeShow=!1},handleSelectReplyTime:function(){this.createTime=this.replyTime?new Date(this.replyTime):new Date,this.replyTimeShow=!0},handleSelectBeginTime:function(){this.createTime=this.beginTime?new Date(this.beginTime):new Date,this.beginTimeShow=!0},handleBeginTimeConfirm:function(e){this.beginTime=d()(e).format("YYYY-MM-DD HH:mm"),this.beginTimeShow=!1},handleSelectFinishTime:function(){this.createTime=this.finishTime?new Date(this.finishTime):new Date,this.finishTimeShow=!0},handleFinishTimeConfirm:function(e){this.finishTime=d()(e).format("YYYY-MM-DD HH:mm"),this.finishTimeShow=!1},handleSelectRepairTime:function(){this.createTime=this.repairTime?new Date(this.repairTime):new Date,this.repairTimeShow=!0},handleRepairTimeConfirm:function(e){this.repairTime=d()(e).format("YYYY-MM-DD HH:mm"),this.repairTimeShow=!1},handleSelectNoticeTime:function(){this.createTime=this.noticeTime?new Date(this.noticeTime):new Date,this.noticeTimeShow=!0},handleNoticeTimeConfirm:function(e){this.noticeTime=d()(e).format("YYYY-MM-DD HH:mm"),this.noticeTimeShow=!1},handleSelectContractor:function(){this.contractorShow=!0,this.contractorRadio=b({},this.problemDetail.contractor)},onContractorSelect:function(){this.problemDetail.contractor=b({},this.contractorRadio),this.contractorShow=!1},handleSelectLine:function(){s["a"].open("address")},handleSelectSource:function(){this.sourceShow=!0,this.sourceRadio=b({},this.reason)},onSourceSelect:function(){this.source=b({},this.sourceRadio),this.sourceShow=!1},handleSelectProfession:function(){this.professionShow=!0,this.professionRadio=b({},this.profession)},onProfessionSelect:function(){this.profession=b({},this.professionRadio),this.professionShow=!1},handleSelectDeviceCategory:function(){s["a"].open("deviceCategory",{profession:this.profession?this.profession.id:null})},beforeClose:function(e,t){"confirm"===e?this.imageList.push({url:this.imgFile,description:this.description}):this.imageList.push({url:this.imgFile,description:""}),t()},handleCancel:function(){s["a"].back()},validateData:function(){var e=[];return this.category&&this.category.id||e.push("问题分类"),this.level&&this.level.id||e.push("问题等级"),this.problemDetail.analysis||e.push("初步原因分析"),this.problemDetail.beginSolutions||e.push("初步解决方案"),this.problemDetail.finishSolutions||e.push("最终解决方案"),e},handleCirculation:function(){var e=this;console.log(this.problemDetail);var t=this.validateData();if(t.length)return this.$toast(t.join("、")+" 未填写"),!1;this.$toast.loading({duration:0,loadingType:"spinner"}),p["a"].saveProblem(b({},this.problemDetail,{images:this.imageList,videos:this.videoList,category:this.category,level:this.level,contractorReplyTime:this.replyTime,contractorBeginTime:this.beginTime,contractorFinishTime:this.finishTime,repairFinishTime:this.repairTime,noRepairTime:this.noRepairTime,contractorNoticeTime:this.noticeTime})).then((function(){e.$toast.clear(),s["a"].open("circulation",{id:e.id,flow:JSON.stringify(e.flow),job:"engineer_charge",profession:e.problemDetail.professionId,status:e.problemDetail.status})}))},handleSave:function(){var e=this,t=this.validateData();if(t.length)return this.$toast(t.join("、")+" 未填写"),!1;this.$toast.loading({duration:0,loadingType:"spinner"}),p["a"].saveProblem(b({},this.problemDetail,{images:this.imageList,videos:this.videoList,category:this.category,level:this.level,contractorReplyTime:this.replyTime,contractorBeginTime:this.beginTime,contractorFinishTime:this.finishTime,repairFinishTime:this.repairTime,noRepairTime:this.noRepairTime,contractorNoticeTime:this.noticeTime,line:this.line,station:this.station,source:this.source,profession:this.profession,deviceCategory:this.deviceCategory})).then((function(){f["a"].connection()?p["a"].getProblemDetail(e.id).then((function(t){Object(h["b"])(t.images).then((function(i){t.images=i,Object(h["c"])(t.videos).then((function(i){t.videos=i,m["a"].submitProblemData({id:t.id,level:t.level.id,category:t.category.id,analysis:t.analysis,beginSolutions:t.beginSolutions,finishSolutions:t.finishSolutions,remark:t.remark||"",images:t.images,videos:t.videos,noRepairTime:t.noRepairTime?t.noRepairTime.substr(0,16)+":00":"",contractor:t.contractor?t.contractor.id:"",contractorReplyTime:t.contractorReplyTime?t.contractorReplyTime.substr(0,16)+":00":"",contractorBeginTime:t.contractorBeginTime?t.contractorBeginTime.substr(0,16)+":00":"",contractorFinishTime:t.contractorFinishTime?t.contractorFinishTime.substr(0,16)+":00":"",repairFinishTime:t.repairFinishTime?t.repairFinishTime.substr(0,16)+":00":"",contractorNoticeTime:t.contractorNoticeTime?t.contractorNoticeTime.substr(0,16)+":00":"",line:t.line?t.line.id:"",station:t.station?t.station.id:"",address:t.address,profession:t.profession?t.profession.id:"",deviceCategory:t.deviceCategory?t.deviceCategory.id:"",source:t.source?t.source.id:""}).then((function(){s["a"].back()})).catch((function(t){e.$toast(t)}))})).watch((function(t){e.$toast(t)}))})).watch((function(t){e.$toast(t)}))})):(alert("已自动保存数据，请在网络环境下提交"),e.$toast.clear())}))},handleSubmit:function(){var e=this,t=this.validateData();if(t.length)return this.$toast(t.join("、")+" 未填写"),!1;this.$dialog.confirm({message:"是否确认提交审核？"}).then((function(){e.$toast.loading({duration:0,forbidClick:!0,loadingType:"spinner",message:"正在提交..."}),p["a"].saveProblem(b({},e.problemDetail,{images:e.imageList,videos:e.videoList,category:e.category,level:e.level,contractorReplyTime:e.replyTime,contractorBeginTime:e.beginTime,contractorFinishTime:e.finishTime,repairFinishTime:e.repairTime,noRepairTime:e.noRepairTime,contractorNoticeTime:e.noticeTime,line:e.line,station:e.station,profession:e.profession,deviceCategory:e.deviceCategory,source:e.source})).then((function(){e.$toast.clear(),s["a"].open("circulation",{id:e.id,flow:JSON.stringify(e.flow),job:"engineer_charge",profession:e.problemDetail.professionId,status:e.problemDetail.status})}))}))}}},T=g,y=(i("fcdf"),i("2877")),S=Object(y["a"])(T,o,a,!1,null,null,null),k=S.exports,w=i("a1db");w["a"].init(k)},b29f:function(e,t,i){},fcdf:function(e,t,i){"use strict";var o=i("b29f"),a=i.n(o);a.a}});
//# sourceMappingURL=follow.28aefc4a.js.map