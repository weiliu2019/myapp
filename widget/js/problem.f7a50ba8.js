(function(e){function t(t){for(var a,r,s=t[0],l=t[1],c=t[2],d=0,u=[];d<s.length;d++)r=s[d],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&u.push(o[r][0]),o[r]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);f&&f(t);while(u.length)u.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,s=1;s<n.length;s++){var l=n[s];0!==o[l]&&(a=!1)}a&&(i.splice(t--,1),e=r(r.s=n[0]))}return e}var a={},o={problem:0},i=[];function r(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var f=l;i.push([32,"chunk-vendors","chunk-common"]),n()})({32:function(e,t,n){e.exports=n("f70b")},"724e":function(e,t,n){"use strict";var a=n("d6a8"),o=n.n(a);o.a},d071:function(e,t,n){"use strict";var a=n("d60d"),o=n.n(a);o.a},d60d:function(e,t,n){},d6a8:function(e,t,n){},f70b:function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("page",{ref:"page",staticClass:"problem-page create-action-page",attrs:{headerHeightVW:e.headerHeightVW,scrollbar:"",pullDownRefresh:!0,pullUpLoad:!0},on:{"on-ready":e.onReady,"on-refresh":e.onRefresh,"on-show":e.onShow,"on-load":e.onLoad}},[n("div",{attrs:{slot:"header"},slot:"header"},[n("van-nav-bar",{attrs:{id:"header",title:"智能维修"}},[n("i",{staticClass:"icon-wode nav-icon-right",attrs:{slot:"right"},on:{click:e.handleToMe},slot:"right"})]),n("van-popup",{staticClass:"header-more",style:{top:e.moreTop+"vw"},model:{value:e.moreAction,callback:function(t){e.moreAction=t},expression:"moreAction"}},[n("div",{staticClass:"more-action"},[n("van-cell",{attrs:{title:"提报故障",clickable:""},nativeOn:{click:function(t){return e.handleCreateFault(t)}}}),n("van-cell",{attrs:{title:"提报问题",clickable:""},nativeOn:{click:function(t){return e.handleCreateProblem(t)}}})],1)]),n("div",{staticClass:"search-bar"},[n("van-search",{attrs:{placeholder:"搜索问题编号、摘要"},model:{value:e.filter.key,callback:function(t){e.$set(e.filter,"key",t)},expression:"filter.key"}})],1),n("van-dropdown-menu",{staticClass:"select-bar"},[n("van-dropdown-item",{attrs:{options:e.statusOptions},model:{value:e.filter.status,callback:function(t){e.$set(e.filter,"status",t)},expression:"filter.status"}}),n("van-dropdown-item",{attrs:{options:e.professionOptions},model:{value:e.filter.profession,callback:function(t){e.$set(e.filter,"profession",t)},expression:"filter.profession"}}),n("van-dropdown-item",{ref:"beginDate",attrs:{title:e.filter.beginDate}},[n("van-datetime-picker",{attrs:{type:"date"},on:{cancel:e.onBeginDateCancel,confirm:e.onBeginDateConfirm},model:{value:e.beginDate,callback:function(t){e.beginDate=t},expression:"beginDate"}})],1),n("van-dropdown-item",{ref:"endDate",attrs:{title:e.filter.endDate}},[n("van-datetime-picker",{attrs:{type:"date"},on:{cancel:e.onEndDateCancel,confirm:e.onEndDateConfirm},model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}})],1)],1)],1),e.loading?n("van-loading",{staticClass:"page-loading",attrs:{type:"spinner"}}):e._e(),e.list.length?e._e():n("div",{staticStyle:{"text-align":"center","line-height":"100px"}},[e._v("暂无数据")]),n("transition-group",{staticClass:"problem-list",attrs:{tag:"div",name:"list"}},e._l(e.list,(function(t){return e.list.length?n("item",{key:t.id,attrs:{data:t},nativeOn:{click:function(n){return e.handleDetail(t)}}}):e._e()})),1),n("template",{slot:"blank"},[n("div",{staticClass:"fault-action",on:{click:e.handleCreateFault}}),n("div",{staticClass:"problem-action",on:{click:e.handleCreateProblem}})])],2)},o=[],i=(n("d25f"),n("20d6"),n("7f7f"),n("6d67"),n("75fc")),r=n("9973"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"problem-item"},[n("div",{staticClass:"item-header"},[n("div",{staticClass:"left"},[n("span",[e._v(e._s(e.data.no))])]),n("div",{staticClass:"right"},[n("span",{staticClass:"item-status"},[e._v(e._s(e.problemStatusEnum[e.data.status]))])])]),n("div",{staticClass:"item-content"},[e.data.profession||e.data.level?n("span",{staticClass:"item-level"},[e._v("【"+e._s(0==e.data.profession?"":e.data.profession)+e._s(e.data.profession&&e.data.level?" - ":"")+e._s("object"==typeof e.data.level?e.data.level.name:e.data.level)+"】")]):e._e(),e._v("\n    "+e._s(e.data.description)+"\n  ")]),n("div",{staticClass:"item-cell"},[n("div",{staticClass:"item-time1"},[e._v("计划完成时间："+e._s(e.data.finishTime))]),n("div",{staticClass:"item-time2"},[e._v(e._s(e.data.consumeTime)+" min")])])])},l=[],c=n("08f3"),f={props:["data"],data:function(){return{problemStatusEnum:c["d"]}}},d=f,u=(n("724e"),n("2877")),p=Object(u["a"])(d,s,l,!1,null,null,null),h=p.exports,m=n("c03e"),g=n("365c"),v=(n("8149"),n("c1df")),b=n.n(v),_={components:{Page:r["a"],Item:h},data:function(){return{headerHeightVW:17.6,moreAction:!1,moreTop:0,header:null,filter:{key:"",status:"",profession:"",pageIndex:1,pageSize:10,beginDate:b()().startOf("years").format("YYYY-MM-DD"),endDate:b()().endOf("years").format("YYYY-MM-DD")},problemStatusEnum:c["d"],list:[],loading:!0,statusOptions:[{text:"全部",value:""},{text:"待受理",value:"wait_assigned"},{text:"跟进中",value:"following_up"},{text:"待审核",value:"pending_review"},{text:"已关闭",value:"close"}],professionOptions:[{text:"全部",value:""}],beginDate:new Date,endDate:new Date}},methods:{onReady:function(e,t){var n;this.header=e,console.log(JSON.stringify(e)),console.log(JSON.stringify(t)),this.headerHeightVW=100*(this.header.h+95)/this.header.w,this.moreTop=100*this.header.h/this.header.w,this.onRefresh(),this.professionOptions=(n=this.professionOptions).concat.apply(n,Object(i["a"])(JSON.parse(localStorage.getItem("problem_profession")).map((function(e){return{text:e.name,value:e.id}}))))},onMoreAction:function(){this.moreAction=!0},onLoadConfig:function(){g["a"].getProblemConfig().then((function(e){localStorage.setItem("problem_level",JSON.stringify(e.level)),localStorage.setItem("problem_category",JSON.stringify(e.category)),localStorage.setItem("problem_flow",JSON.stringify(e.processflow)),localStorage.setItem("problem_address",JSON.stringify(e.address)),localStorage.setItem("problem_profession",JSON.stringify(e.profession)),localStorage.setItem("problem_source",JSON.stringify(e.source))}))},onShow:function(){var e=this;localStorage.getItem("refresh_problem_id")&&g["a"].getProblemListId({id:localStorage.getItem("refresh_problem_id")}).then((function(t){var n=e.list.findIndex((function(e){return e.id==t.detail.id}));n>=0&&e.$set(e.list,n,t.detail),localStorage.setItem("refresh_problem_id","")}))},onRefresh:function(){var e=this;this.filter.pageIndex=1,g["a"].getProblemList(this.filter).then((function(t){e.list=t.list,e.filter.pageIndex++,e.$refs.page.finishRefresh(),e.loading=!1})).catch((function(t){e.$toast(t),e.$refs.page.finishRefresh(),e.loading=!1}))},onLoad:function(){var e=this;g["a"].getProblemList(this.filter).then((function(t){e.list=e.list.concat(t.list),e.filter.pageIndex++,0==t.list.length?e.$refs.page.endLoad():e.$refs.page.updateLoad(),e.loading=!1})).catch((function(t){e.$toast(t),e.$refs.page.updateLoad(),e.loading=!1}))},handleDetail:function(e){localStorage.setItem("refresh_problem_id",e.id),m["a"].open("problemdetail",{id:e.id})},onBeginDateCancel:function(){this.$refs.beginDate.toggle()},onBeginDateConfirm:function(e){console.log(e),this.filter.beginDate=b()(e).format("YYYY-MM-DD"),this.$refs.beginDate.toggle(),this.onRefresh()},onEndDateCancel:function(){this.$refs.endDate.toggle()},onEndDateConfirm:function(e){console.log(e),this.filter.endDate=b()(e).format("YYYY-MM-DD"),this.$refs.endDate.toggle(),this.onRefresh()},handleCreateFault:function(){this.moreAction=!1,m["a"].open("createFault")},handleCreateProblem:function(){this.moreAction=!1,m["a"].open("createProblem")},handleToMe:function(){m["a"].open("me")}},watch:{"filter.status":function(e){this.onRefresh()},"filter.profession":function(e){this.onRefresh()},"filter.key":function(e){this.onRefresh()}}},y=_,D=(n("d071"),Object(u["a"])(y,a,o,!1,null,null,null)),C=D.exports,O=n("a1db");O["a"].init(C)}});
//# sourceMappingURL=problem.f7a50ba8.js.map