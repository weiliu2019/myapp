(function(t){function a(a){for(var i,o,l=a[0],c=a[1],r=a[2],u=0,g=[];u<l.length;u++)o=l[u],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&g.push(n[o][0]),n[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);d&&d(a);while(g.length)g.shift()();return s.push.apply(s,r||[]),e()}function e(){for(var t,a=0;a<s.length;a++){for(var e=s[a],i=!0,l=1;l<e.length;l++){var c=e[l];0!==n[c]&&(i=!1)}i&&(s.splice(a--,1),t=o(o.s=e[0]))}return t}var i={},n={orderdetail:0},s=[];function o(a){if(i[a])return i[a].exports;var e=i[a]={i:a,l:!1,exports:{}};return t[a].call(e.exports,e,e.exports,o),e.l=!0,e.exports}o.m=t,o.c=i,o.d=function(t,a,e){o.o(t,a)||Object.defineProperty(t,a,{enumerable:!0,get:e})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,a){if(1&a&&(t=o(t)),8&a)return t;if(4&a&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(o.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&a&&"string"!=typeof t)for(var i in t)o.d(e,i,function(a){return t[a]}.bind(null,i));return e},o.n=function(t){var a=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(a,"a",a),a},o.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)},o.p="";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=a,l=l.slice();for(var r=0;r<l.length;r++)a(l[r]);var d=c;s.push([24,"chunk-vendors","chunk-common"]),e()})({"02da":function(t,a,e){"use strict";e.r(a);e("cadf"),e("551c"),e("f751"),e("097d");var i=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("page",{ref:"page",staticClass:"orderdetail-page common-page",attrs:{headerHeightVW:t.headerHeightVW,scrollbar:""},on:{"on-ready":t.onReady,"on-show":t.onShow}},[i("van-nav-bar",{attrs:{slot:"header",id:"header",title:"工单详情","left-arrow":""},on:{"click-left":t.onClickLeft},slot:"header"},[i("img",{staticClass:"action-menu",attrs:{slot:"right",src:e("d226"),alt:"icon"},on:{click:t.handleReferences},slot:"right"})]),t.detail.id?i("detail",{attrs:{data:t.detail},on:{"show-suggestion":t.onShowSuggestion,"show-daiagnosis":t.onShowDiagnosis}}):t._e(),i("div",{staticClass:"blank-empty"}),i("template",{slot:"blank"},["assigned"==t.detail.status?i("div",{staticClass:"footer-action"},["monitor"==t.user.position_id?i("div",{staticClass:"action-item",on:{click:t.handleHang}},[i("i",{staticClass:"action-item-icon icon-guaqi"}),i("span",[t._v("挂起")])]):t._e(),i("van-button",{staticClass:"action-item-main",attrs:{color:"#108EE9"},nativeOn:{click:function(a){return t.handleReceive(a)}}},[t._v("接报")])],1):t._e(),"pending_sign"==t.detail.status?i("div",{staticClass:"footer-action"},["monitor"==t.user.position_id?i("div",{staticClass:"action-item",on:{click:t.handleHang}},[i("i",{staticClass:"action-item-icon icon-guaqi"}),i("span",[t._v("挂起")])]):t._e(),i("div",{staticClass:"action-item",on:{click:t.handleForward}},[i("i",{staticClass:"action-item-icon icon-zhuanfa"}),i("span",[t._v("转发")])]),i("van-button",{staticClass:"action-item-main",attrs:{color:"#108EE9",disabled:!t.detail.currentUser&&!t.detail.currentUser.id&&t.user.id!=t.detail.currentUser.id},nativeOn:{click:function(a){return t.handleSign(a)}}},[t._v("签到")])],1):t._e(),"waiting_repair"==t.detail.status?i("div",{staticClass:"footer-action"},["monitor"==t.user.position_id?i("div",{staticClass:"action-item",on:{click:t.handleHang}},[i("i",{staticClass:"action-item-icon icon-guaqi"}),i("span",[t._v("挂起")])]):t._e(),i("div",{staticClass:"action-item",on:{click:t.handleClearup}},[i("i",{staticClass:"action-item-icon icon-xiaoxiang"}),i("span",[t._v("销项")])]),i("div",{staticClass:"action-item",on:{click:t.handleForward}},[i("i",{staticClass:"action-item-icon icon-zhuanfa"}),i("span",[t._v("转发")])]),i("van-button",{staticClass:"action-item-main",attrs:{color:"#108EE9",disabled:!t.detail.currentUser&&!t.detail.currentUser.id&&t.user.id!=t.detail.currentUser.id},nativeOn:{click:function(a){return t.handleRepair(a)}}},[t._v("维修")])],1):t._e(),i("van-popup",{staticClass:"filter-popup",attrs:{position:"bottom","lock-scroll":!1,closeable:"","close-icon":"close",round:""},model:{value:t.suggestionShow,callback:function(a){t.suggestionShow=a},expression:"suggestionShow"}},[i("div",{staticClass:"title"},[t._v("维修建议")]),t.suggestionShow?i("a-scroll",{ref:"filterScroller",staticClass:"filter-scroll"},[i("div",{staticStyle:{padding:"16px"}},[t._v("\n          "+t._s(t.detail.repairSuggestion)+"\n        ")])]):t._e(),i("div",{staticClass:"footer-action"},[i("van-button",{staticClass:"action-item-main",attrs:{color:"#108EE9"},on:{click:function(a){t.suggestionShow=!1}}},[t._v("关闭")])],1)],1),i("van-popup",{staticClass:"filter-popup",attrs:{position:"bottom","lock-scroll":!1,closeable:"","close-icon":"close",round:""},model:{value:t.diagnosisShow,callback:function(a){t.diagnosisShow=a},expression:"diagnosisShow"}},[i("div",{staticClass:"title"},[t._v("专家诊断")]),t.diagnosisShow?i("a-scroll",{ref:"filterScroller",staticClass:"filter-scroll"},t._l(t.diagnosisData,(function(a,e){return i("van-cell-group",{key:e},[i("van-cell",{staticClass:"detail-title",attrs:{title:"故障原因："}}),i("van-cell",[i("span",{staticStyle:{color:"#969799"}},[t._v(t._s(a.failure_reason))])]),i("van-cell",{staticClass:"detail-title",attrs:{title:"分析："}}),i("van-cell",[i("span",{staticStyle:{color:"#969799"}},[t._v(t._s(a.failure_parse))])]),i("van-cell",{staticClass:"detail-title",attrs:{title:"检查方法："}}),i("van-cell",[i("span",{staticStyle:{color:"#969799"}},[t._v(t._s(a.troubleshoot))])])],1)})),1):t._e(),i("div",{staticClass:"footer-action"},[i("van-button",{staticClass:"action-item-main",attrs:{color:"#108EE9"},on:{click:function(a){t.diagnosisShow=!1}}},[t._v("关闭")])],1)],1)],1)],2)},n=[],s=(e("1c01"),e("58b2"),e("8e6e"),e("f3e2"),e("d25f"),e("ac6a"),e("456d"),e("bd86")),o=e("9973"),l=function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"detail-container"},[i("div",{staticClass:"detail-header"},[i("div",{staticClass:"detail-cell"},[i("div",{staticClass:"detail-no"},[t._v(t._s(t.data.no))]),i("div",{staticClass:"detail-status"},[t._v(t._s(t.statusEnum[t.data.status]))])]),i("div",{staticClass:"detail-cell"},[i("div",{staticClass:"detail-time1"},[t._v("通报时间: "+t._s(t.data.createTime))]),i("div",{staticClass:"detail-time2"},[t._v(t._s(t.data.timeConsuming)+" min")])])]),i("van-cell-group",[i("van-cell",{attrs:{title:"故障地点："}},[t._v("\n      "+t._s(t.data.line)+" - "+t._s(t.data.station)+"\n    ")]),i("van-cell",{attrs:{title:"故障专业："}},[t._v(t._s(t.data.profession))]),i("van-cell",{attrs:{title:"故障设备："}},[t._v(t._s(t.data.deviceCategory&&t.data.deviceCategory.name)+" / "+t._s(t.data.device&&t.data.device.name))]),i("van-cell",{attrs:{title:"故障时间："}},[t._v(t._s(t.data.faultTime))]),i("van-cell",{attrs:{title:"故障分类："}},[t._v(t._s(t.data.reason&&t.data.reason.name))]),i("van-cell",{attrs:{title:"故障等级："}},[t._v(t._s(t.data.level&&t.data.level.name))])],1),i("van-cell-group",[i("van-cell",{attrs:{title:"维修建议","is-link":"",clickable:""},on:{click:t.handleRepairSuggestion}})],1),i("van-cell-group",[i("van-cell",{attrs:{title:"专家诊断","is-link":"",clickable:""},on:{click:t.handleDiagnosis}})],1),i("van-cell-group",[i("van-cell",{staticClass:"detail-title",attrs:{title:"故障现象："}}),i("van-cell",[i("span",{staticStyle:{color:"#969799"}},[t._v(t._s(t.data.content))])])],1),i("van-cell-group",[i("van-cell",{staticClass:"detail-title",attrs:{title:"图像："}}),i("div",{staticClass:"images-container"},t._l(t.data.images,(function(a,e){return i("div",{key:e,staticClass:"image-item-show",on:{click:function(a){return t.handlePlayImages(e)}}},[i("auto-image",{staticStyle:{"margin-bottom":"12px","margin-left":"12px"},attrs:{src:a.url,width:108,height:108}})],1)})),0)],1),i("van-cell-group",[i("van-cell",{staticClass:"detail-title",attrs:{title:"视频："}}),i("div",{staticClass:"images-container"},t._l(t.data.videos,(function(a,n){return i("div",{key:n,staticClass:"image-item-show",on:{click:function(e){return t.handlePlayVideo(a)}}},[i("img",{staticClass:"img-video",attrs:{src:e("f0f8")}})])})),0)],1),i("van-cell-group",[i("van-cell",{attrs:{title:"维修过程","is-link":"",clickable:""},on:{click:t.handleRecord}})],1)],1)},c=[],r=e("08f3"),d=e("4ff5"),u=e("c03e"),g={props:["data"],components:{AutoImage:d["a"]},data:function(){return{statusEnum:r["e"]}},methods:{handlePlayImages:function(t){localStorage.setItem("photos",JSON.stringify(this.data.images)),u["a"].open("photoViewer",{index:t})},handleRepairSuggestion:function(){this.$emit("show-suggestion")},handleDiagnosis:function(){this.$emit("show-daiagnosis")},handlePlayVideo:function(t){api.openVideo({url:t.url})},handleRecord:function(){u["a"].open("orderRecord",{id:this.data.id})}}},p=g,h=(e("c87b"),e("2877")),v=Object(h["a"])(p,l,c,!1,null,null,null),f=v.exports,m=e("365c"),C=e("8149"),_=e("698a"),b=e("4e1b");function w(t,a){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);a&&(i=i.filter((function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),e.push.apply(e,i)}return e}function y(t){for(var a=1;a<arguments.length;a++){var e=null!=arguments[a]?arguments[a]:{};a%2?w(Object(e),!0).forEach((function(a){Object(s["a"])(t,a,e[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):w(Object(e)).forEach((function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(e,a))}))}return t}var k={components:{Page:o["a"],Detail:f,AScroll:b["a"]},data:function(){return{headerHeightVW:0,id:null,detail:{},online:!1,user:JSON.parse(localStorage.getItem("user")),suggestionShow:!1,diagnosisShow:!1,diagnosisData:[]}},methods:{onReady:function(t,a){this.header=t,this.headerHeightVW=100*(this.header.h+1)/this.header.w,this.id=u["a"].getParam("id"),this.loadDetail()},onShow:function(){this.loadDetail()},onShowSuggestion:function(){this.suggestionShow=!0},onShowDiagnosis:function(){this.diagnosisShow=!0},onClickLeft:function(){u["a"].back()},handleRepair:function(){u["a"].open("repair",{orderid:this.id})},handleSign:function(){u["a"].open("photosign",{orderid:this.id})},loadDetail:function(){var t=this;this.$toast.loading({duration:0,loadingType:"spinner"}),C["a"].getOrderDetail(this.id).then((function(a){a.id==t.id?(t.online=!1,t.detail=y({},a),t.diagnosisData=a.diagnosisData,t.$toast.clear()):(t.online=!0,m["a"].getOrderDetail({id:t.id}).then((function(a){t.detail=y({},a),m["a"].getOrderDiagnosis({id:t.id}).then((function(a){t.diagnosisData=a,"waiting_repair"==t.detail.status||"pending_sign"==t.detail.status?C["a"].saveOrder(y({},t.detail,{type:1,diagnosisData:t.diagnosisData})).then((function(){t.$toast.clear()})):t.$toast.clear()}))})).catch((function(a){t.$toast(a)})))}))},handleReferences:function(){u["a"].open("references",{id:this.detail.device.id||""})},handleReceive:function(){var t=this;this.$toast.loading({duration:0,forbidClick:!0,loadingType:"spinner",message:"正在接报..."}),m["a"].receiveOrder({id:this.detail.id}).then((function(){C["a"].saveOrder(y({},t.detail,{status:"pending_sign",type:1})).then((function(){t.$toast.clear(),t.loadDetail()})).catch((function(a){t.$toast(a)}))})).catch((function(a){t.$toast(a)}))},handleForward:function(){_["a"].connection()?u["a"].open("organization",{id:this.id}):alert("网络无法连接，转发请求失败")},handleClearup:function(){"none"==api.connectionType?alert("网络无法连接，销项请求失败"):u["a"].open("clearup",{orderid:this.id})},handleHang:function(){"none"==api.connectionType?alert("网络无法连接，挂起请求失败"):u["a"].open("hang",{orderid:this.id})}}},S=k,A=(e("28770"),Object(h["a"])(S,i,n,!1,null,null,null)),O=A.exports,D=e("a1db");D["a"].init(O)},1744:function(t,a,e){},24:function(t,a,e){t.exports=e("02da")},28770:function(t,a,e){"use strict";var i=e("8bc6"),n=e.n(i);n.a},"8bc6":function(t,a,e){},c87b:function(t,a,e){"use strict";var i=e("1744"),n=e.n(i);n.a},d226:function(t,a){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAoCAYAAACfKfiZAAACKElEQVRYR+2Yz4uOURTHP1+KjBppFpY2kjSIvR9hStkrKVkoRSkhJCmRhZKFxRRloaz8A1N+7C2MH6UoZSGUDDMseNHR9+2+mqbxzvPep/uYqTmrt/s+93w/z7nn3HvuI4CIWAycAPYBK4GFHi9gv4E3wG3gqqSWkvgIsLWAYDeXD4BdBjgNXG5YvCN30gDPgcE0cgm4ArQKAS0CzgCnkv9RA4wD/WlgQNJYIfG224hYAXxIGmMG+AYsTQP9kr4WBlgOdF5yfB5gdkcgIoaAc0BfZl4EMAoclvQrJWH1HIiIZ8C6TPHJ04Yk3csBuA4cqQnwEVgvqV16EVE9AmnC2kll2iuLl+CVpInOxJ4BelWc6fm5BRAR24GzNZfgMXBUko/i3nIgIp46gWYKa4X/s6tgGDhUQaDbI59cypLe50RAKQJ1NqKXkj7PV0FWBCJiS6qCOkvgKjieWwVPgA01k9DTd0q6n5OEN4CDNQGcgIOS3uUALAA21TyOX0hyKbZtbm3FNUM/7fRZH4H9wG5gNbCkRAQA55X92yamNqWFNP/p9uf/BhiZCuAWyrV/B3AvV8q8DH2SHhngB+BLo+2apGOlVKfzawD3650PEhslefttzAzwBViWFFdJet2YOmAAXxh2JNHzki40DXAAuJVEvRz+QHEX+Lt/FwJquU1zBLz+D4HNhYS6ub3pns8n1EB6620NQ7xtAyQI/94D7AXW1LgLVH2H78DFP+YDkxk79Hn0AAAAAElFTkSuQmCC"}});
//# sourceMappingURL=orderdetail.25f238b2.js.map