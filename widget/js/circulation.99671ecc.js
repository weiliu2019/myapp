(function(e){function t(t){for(var i,a,s=t[0],l=t[1],c=t[2],f=0,d=[];f<s.length;f++)a=s[f],Object.prototype.hasOwnProperty.call(n,a)&&n[a]&&d.push(n[a][0]),n[a]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);u&&u(t);while(d.length)d.shift()();return r.push.apply(r,c||[]),o()}function o(){for(var e,t=0;t<r.length;t++){for(var o=r[t],i=!0,s=1;s<o.length;s++){var l=o[s];0!==n[l]&&(i=!1)}i&&(r.splice(t--,1),e=a(a.s=o[0]))}return e}var i={},n={circulation:0},r=[];function a(t){if(i[t])return i[t].exports;var o=i[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.m=e,a.c=i,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(o,i,function(t){return e[t]}.bind(null,i));return o},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;r.push([3,"chunk-vendors","chunk-common"]),o()})({"111e":function(e,t,o){},3:function(e,t,o){e.exports=o("e44a")},"986b":function(e,t,o){"use strict";var i=o("111e"),n=o.n(i);n.a},e44a:function(e,t,o){"use strict";o.r(t);o("cadf"),o("551c"),o("f751"),o("097d");var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("page",{ref:"page",staticClass:"circulation-page",attrs:{headerHeightVW:e.headerHeightVW,scrollbar:""},on:{"on-ready":e.onReady,"on-show":e.onShow}},[o("van-nav-bar",{attrs:{slot:"header",id:"header",title:"流转下级","left-arrow":""},on:{"click-left":e.onClickLeft},slot:"header"}),o("van-cell-group",[o("van-cell",{attrs:{title:"当前流程："}},[e._v(e._s(e.oldflow&&e.oldflow.name))])],1),o("van-cell-group",[o("van-cell",{attrs:{title:"选择下级处理人","is-link":"",clickable:""},on:{click:e.handleSelectUser}},[o("span",[e._v(e._s(e.user&&e.user.name||"请选择"))])])],1),o("template",{slot:"blank"},[o("van-popup",{staticClass:"filter-popup",attrs:{position:"bottom","lock-scroll":!1,closeable:"","close-icon":"close",round:""},model:{value:e.flowShow,callback:function(t){e.flowShow=t},expression:"flowShow"}},[o("div",{staticClass:"title"},[e._v("\n        选择下级流程\n      ")]),e.flowShow?o("a-scroll",{ref:"filterScroller",staticClass:"filter-scroll"},[o("van-radio-group",{model:{value:e.flowRadio.id,callback:function(t){e.$set(e.flowRadio,"id",t)},expression:"flowRadio.id"}},[o("van-cell-group",e._l(e.flowOptions,(function(t,i){return o("van-cell",{key:i,attrs:{title:t.name,label:t.description,clickable:""},on:{click:function(o){e.flowRadio=Object.assign({},t)}}},[o("van-radio",{attrs:{slot:"right-icon",name:t.id},slot:"right-icon"})],1)})),1)],1)],1):e._e(),o("div",{staticClass:"footer-action"},[o("van-button",{staticClass:"action-item-main",attrs:{color:"#108EE9"},on:{click:e.onFlowSelect}},[e._v("确定")])],1)],1),o("van-popup",{staticClass:"filter-popup",attrs:{position:"bottom","lock-scroll":!1,closeable:"","close-icon":"close",round:""},model:{value:e.userShow,callback:function(t){e.userShow=t},expression:"userShow"}},[o("div",{staticClass:"title"},[e._v("\n        选择下级处理人\n      ")]),e.userShow?o("a-scroll",{ref:"filterScroller",staticClass:"filter-scroll"},[o("van-radio-group",{model:{value:e.userRadio.id,callback:function(t){e.$set(e.userRadio,"id",t)},expression:"userRadio.id"}},[o("van-cell-group",e._l(e.userOptions,(function(t,i){return o("van-cell",{key:i,attrs:{title:t.name,label:t.description,clickable:""},on:{click:function(o){e.userRadio=Object.assign({},t)}}},[o("van-radio",{attrs:{slot:"right-icon",name:t.id},slot:"right-icon"}),o("img",{staticClass:"user-icon",attrs:{slot:"icon",src:t.avator},slot:"icon"})],1)})),1)],1)],1):e._e(),o("div",{staticClass:"footer-action"},[o("van-button",{staticClass:"action-item-main",attrs:{color:"#108EE9"},on:{click:e.onUserSelect}},[e._v("确定")])],1)],1),o("div",{staticClass:"footer-action"},[o("van-button",{staticClass:"action-item-main",attrs:{disabled:!e.user||!e.user.id,color:"#108EE9"},on:{click:e.handleConfirm}},[e._v("确认")])],1)],1)],2)},n=[],r=(o("1c01"),o("58b2"),o("8e6e"),o("f3e2"),o("d25f"),o("ac6a"),o("456d"),o("7f7f"),o("bd86")),a=o("9973"),s=o("365c"),l=o("c03e"),c=o("4e1b"),u=o("8149"),f=o("0e5c");function d(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function p(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?d(Object(o),!0).forEach((function(t){Object(r["a"])(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):d(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var h={components:{Page:a["a"],AScroll:c["a"]},data:function(){return{headerHeightVW:0,id:null,flow:null,oldflow:null,flowShow:!1,flowRadio:null,flowOptions:JSON.parse(localStorage.getItem("problem_flow")),user:null,userShow:!1,userRadio:null,userOptions:null,job:"",profession:"",status:""}},methods:{onReady:function(e,t){this.headerHeightVW=100*(e.h+1)/e.w,this.id=l["a"].getParam("id"),this.oldflow=JSON.parse(l["a"].getParam("flow")),this.job=l["a"].getParam("job"),this.profession=l["a"].getParam("profession"),this.status=l["a"].getParam("status"),localStorage.setItem("circulation_select","")},onShow:function(){localStorage.getItem("circulation_select")?this.user=JSON.parse(localStorage.getItem("circulation_select")):this.user=null},onClickLeft:function(){l["a"].back()},handleSelectFlow:function(){this.flowShow=!0,this.flow?this.flowRadio=p({},this.flow):this.flowRadio={}},onFlowSelect:function(){this.flow=p({},this.flowRadio),this.flowShow=!1},handleSelectUser:function(){l["a"].open("organization",{id:this.id,mode:"problem_circulation",job:this.job,profession:this.profession,status:this.status})},onUserSelect:function(){this.user=p({},this.userRadio),this.userShow=!1},handleConfirm:function(){var e=this;this.$dialog.confirm({message:"是否确认流转该问题给".concat(this.user.name)}).then((function(){e.$toast.loading({duration:0,forbidClick:!0,loadingType:"spinner",message:"正在流转..."}),"none"==api.connectionType?(alert("已自动保存数据，请在网络环境下提交"),e.$toast.clear()):"senior_engineer_business"==e.job||"engineer_duty"==e.job?s["a"].passProblem({id:e.id,userId:e.user.id}).then((function(){e.$toast.clear(),localStorage.setItem("redirect","problemRecord"),l["a"].back("follow"),l["a"].back("circulation")})).catch((function(t){e.$toast(t)})):u["a"].getProblemDetail(e.id).then((function(t){Object(f["b"])(t.images).then((function(o){t.images=o,Object(f["c"])(t.videos).then((function(o){t.videos=o,s["a"].submitProblemData({id:t.id,level:t.level.id,category:t.category.id,analysis:t.analysis,beginSolutions:t.beginSolutions,finishSolutions:t.finishSolutions,remark:t.remark||"",images:t.images,videos:t.videos,noRepairTime:t.noRepairTime,contractor:t.contractor?t.contractor.id:"",contractorReplyTime:t.contractorReplyTime?t.contractorReplyTime.substr(0,16)+":00":"",contractorBeginTime:t.contractorBeginTime?t.contractorBeginTime.substr(0,16)+":00":"",contractorFinishTime:t.contractorFinishTime?t.contractorFinishTime.substr(0,16)+":00":"",repairFinishTime:t.repairFinishTime?t.repairFinishTime.substr(0,16)+":00":"",contractorNoticeTime:t.contractorNoticeTime?t.contractorNoticeTime.substr(0,16)+":00":"",line:t.line?t.line.id:"",station:t.station?t.station.id:"",address:t.address,profession:t.profession?t.profession.id:"",deviceCategory:t.deviceCategory?t.deviceCategory.id:"",source:t.source?t.source.id:""}).then((function(){s["a"].flowProblem({id:e.id,userId:e.user.id,images:t.images,videos:t.videos}).then((function(){e.$toast.clear(),localStorage.setItem("redirect","problemRecord"),l["a"].back("follow"),l["a"].back("circulation")})).catch((function(t){e.$toast(t)}))})).catch((function(t){e.$toast(t)}))}))}))}))}))}}},b=h,m=(o("986b"),o("2877")),g=Object(m["a"])(b,i,n,!1,null,null,null),v=g.exports,w=o("a1db");w["a"].init(v)}});
//# sourceMappingURL=circulation.99671ecc.js.map