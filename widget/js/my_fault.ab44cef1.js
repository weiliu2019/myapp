(function(t){function e(e){for(var n,r,o=e[0],l=e[1],c=e[2],d=0,u=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&u.push(i[r][0]),i[r]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);f&&f(e);while(u.length)u.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],n=!0,o=1;o<a.length;o++){var l=a[o];0!==i[l]&&(n=!1)}n&&(s.splice(e--,1),t=r(r.s=a[0]))}return t}var n={},i={my_fault:0},s=[];function r(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=n,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(a,n,function(e){return t[e]}.bind(null,n));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var f=l;s.push([21,"chunk-vendors","chunk-common"]),a()})({21:function(t,e,a){t.exports=a("8a22")},2483:function(t,e,a){"use strict";var n=a("f443"),i=a.n(n);i.a},"8a22":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page",{ref:"page",staticClass:"myquestion-page",attrs:{headerHeightVW:t.headerHeightVW,scrollbar:"",pullDownRefresh:!0,pullUpLoad:!0},on:{"on-ready":t.onReady,"on-refresh":t.onRefresh,"on-show":t.onShow,"on-load":t.onLoad}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("van-nav-bar",{attrs:{id:"header",title:"我提报的故障","left-arrow":""},on:{"click-left":t.onClickLeft}}),a("div",{staticClass:"search-bar"},[a("van-search",{attrs:{placeholder:"请输入搜索工单编号"},model:{value:t.filter.key,callback:function(e){t.$set(t.filter,"key",e)},expression:"filter.key"}}),a("div",{staticClass:"search-action"},[a("i",{staticClass:"search-scan search-icon"}),a("i",{staticClass:"search-filter search-icon",on:{click:t.handleFilter}})])],1)],1),t.loading?a("van-loading",{staticClass:"page-loading",attrs:{type:"spinner"}}):t._e(),a("div",{staticClass:"myquestion-content"},t._l(t.list,(function(e){return a("div",{key:e.id,staticClass:"myquestion-item",on:{click:function(a){return t.handleDetail(e)}}},[a("div",{staticClass:"item-title"},[a("span",[t._v(t._s(e.no))]),a("span",{staticClass:"gz"},[t._v("故障")]),"wait_assigned"==e.state?a("span",{staticClass:"item.status",staticStyle:{color:"#ffb105"}},[t._v("待受理")]):"assigned"==e.state?a("span",{staticClass:"item-status",staticStyle:{color:"#ffb105"}},[t._v("待关闭")]):"neglected"==e.state?a("span",{staticClass:"item-status",staticStyle:{color:"#ffb105"}},[t._v("已忽略")]):"close"==e.state?a("span",{staticClass:"item-status",staticStyle:{color:"#ffb105"}},[t._v("已关闭")]):"create"==e.state?a("span",{staticClass:"item-status"},[t._v("转提报")]):t._e()]),a("div",{staticClass:"item-content"},[e.isEmergency?a("van-icon",{attrs:{name:"warning"}}):t._e(),a("span",{staticClass:"content"},[e.isEmergency?a("span",{staticClass:"jj"},[t._v("【紧急】")]):t._e(),t._v(t._s(e.content))])],1),a("div",{staticClass:"item-address"},[a("van-icon",{attrs:{name:"location-o"}}),a("span",{staticClass:"addr"},[t._v(t._s(e.line)+"-"+t._s(e.station))])],1),a("div",{staticClass:"item-time"},[a("van-icon",{attrs:{name:"clock-o"}}),a("span",{staticClass:"time"},[t._v("通报时间："+t._s(e.createTime))]),a("span",{staticClass:"y-time"},[t._v(t._s(e.timeConsuming)+"min")])],1)])})),0),a("template",{slot:"bar"},[a("van-popup",{staticClass:"order-filter-popup",attrs:{position:"right","lock-scroll":!1},model:{value:t.filterShow,callback:function(e){t.filterShow=e},expression:"filterShow"}},[t.filterShow?a("a-scroll",{ref:"filterScroller",staticClass:"order-filter-scroll",attrs:{scrollbar:""}},[a("div",{staticClass:"order-filter-content"},[a("van-cell-group",{attrs:{title:"线别站点",border:!1}},[a("van-button",{staticClass:"xbzd",attrs:{type:"default"},on:{click:t.handleSelectLine}},[t._v("\n              "+t._s(t.line&&t.line.name)+" / "+t._s(t.station&&t.station.name)+"\n            ")])],1),a("van-cell-group",{attrs:{title:"状态筛选",border:!1}},[a("van-row",{staticClass:"filter-options",attrs:{gutter:"10"}},t._l(t.falutStatusEnum,(function(e,n){return a("van-col",{key:n,attrs:{span:"8"}},[a("div",{staticClass:"filter-options-item",class:{"is-active":t.tempFilter.status.indexOf(n)>=0},on:{click:function(e){return t.handleToggleStatus(n)}}},[t._v("\n                  "+t._s(e)+"\n                ")])])})),1)],1),a("van-cell-group",{attrs:{title:"通报时间",border:!1}},[a("van-dropdown-menu",{staticClass:"select-bar"},[a("van-dropdown-item",{ref:"startTime",attrs:{title:t.filter.startTime}},[a("van-datetime-picker",{attrs:{type:"date"},on:{cancel:t.onBeginDateCancel,confirm:t.onBeginDateConfirm},model:{value:t.startTime,callback:function(e){t.startTime=e},expression:"startTime"}})],1),a("van-dropdown-item",{ref:"endTime",attrs:{title:t.filter.endTime}},[a("van-datetime-picker",{attrs:{type:"date"},on:{cancel:t.onEndDateCancel,confirm:t.onEndDateConfirm},model:{value:t.endTime,callback:function(e){t.endTime=e},expression:"endTime"}})],1)],1)],1)],1)]):t._e(),a("div",{staticClass:"order-filter-action"},[a("van-button",{attrs:{color:"#108EE9"},nativeOn:{click:function(e){return t.handleConfirmFilter(e)}}},[t._v("确定")])],1)],1)],1)],2)},i=[],s=(a("1c01"),a("58b2"),a("8e6e"),a("f3e2"),a("ac6a"),a("456d"),a("20d6"),a("57e7"),a("28a5"),a("bd86")),r=a("75fc"),o=(a("d25f"),a("9973")),l=a("4e1b"),c=a("c03e"),f=a("365c"),d=a("8149"),u=a("08f3"),h=a("c1df"),p=a.n(h);function g(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function m(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?g(Object(a),!0).forEach((function(e){Object(s["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var v={components:{Page:o["a"],AScroll:l["a"]},data:function(){return{headerHeightVW:17.6,header:null,filter:{id:"",key:"",status:"wait_assigned,assigned,neglected,close,create",line:"",station:"",startTime:p()().startOf("month").format("YYYY-MM-DD"),endTime:p()().endOf("month").format("YYYY-MM-DD"),pageIndex:1,pageSize:5},tempFilter:{},filterShow:!1,falutStatusEnum:u["a"],loading:!0,list:[],localList:[],startTime:new Date,endTime:new Date,line:null,station:null}},methods:{onReady:function(t,e){this.header=t,this.headerHeightVW=100*(this.header.h+60)/this.header.w,localStorage.setItem("address_select","");var a=localStorage.getItem("user");this.filter.id=JSON.parse(a).id,this.loadLocalData(),setTimeout((function(){c["a"].back("createFault")}),600)},onClickLeft:function(){c["a"].back()},onShow:function(){if(localStorage.getItem("address_select")){var t=JSON.parse(localStorage.getItem("address_select"));this.line=t[0],this.station=t[t.length-1],localStorage.setItem("address_select","")}this.loadLocalData()},loadLocalData:function(){var t=this;this.localList=[],d["a"].getMyFault().then((function(e){t.localList=e,t.onRefresh()}))},onRefresh:function(){var t=this;this.filter.pageIndex=1,f["a"].getMyFault(this.filter).then((function(e){t.list=[].concat(Object(r["a"])(t.localList),Object(r["a"])(e.list)),t.filter.pageIndex++,t.$refs.page.finishRefresh(),t.loading=!1})).catch((function(e){t.$toast(e),t.$refs.page.finishRefresh(),t.loading=!1,t.list=t.localList}))},onLoad:function(){var t=this;f["a"].getMyFault(this.filter).then((function(e){t.list=t.list.concat(e.list),t.filter.pageIndex++,0==e.list.length?t.$refs.page.endLoad():t.$refs.page.updateLoad(),t.loading=!1})).catch((function(e){t.$toast(e),t.$refs.page.updateLoad(),t.loading=!1}))},handleFilter:function(){this.tempFilter=m({},this.filter),this.filterShow=!0},handleConfirmFilter:function(){this.filterShow=!1,this.onRefresh()},handleDetail:function(t){"create"==t.state?c["a"].open("createFault",{detail:t.id}):c["a"].open("faultdetail",{id:t.id})},handleToggleStatus:function(t){var e=this.tempFilter.status.split(",");this.tempFilter.status.indexOf(t)>=0?e.splice(e.findIndex((function(e){return e==t})),1):e.push(t),this.tempFilter.status=e.join(","),this.filter.status=this.tempFilter.status},handleSelectLine:function(){c["a"].open("address")},onBeginDateCancel:function(){this.$refs.startTime.toggle()},onBeginDateConfirm:function(t){this.filter.startTime=p()(t).format("YYYY-MM-DD"),this.$refs.startTime.toggle(),this.onRefresh()},onEndDateCancel:function(){this.$refs.endTime.toggle()},onEndDateConfirm:function(t){this.filter.endTime=p()(t).format("YYYY-MM-DD"),this.$refs.endTime.toggle(),this.onRefresh()}},watch:{tabActive:function(t){var e=this;this.loading=!0,0==t&&(this.filter.status="assigned,pending_sign,waiting_repair,pending_submission,pending_item_review,pending_review,close,sold_item,hang",this.filter.pageIndex=1),1==t&&(this.filter.status="assigned",this.filter.pageIndex=1),3==t&&(this.filter.status="pending_item_review,pending_review",this.filter.pageIndex=1),4==t&&(this.filter.status="hang",this.filter.pageIndex=1),5==t&&(this.filter.status="close,sold_item",this.filter.pageIndex=1),this.$nextTick((function(){e.onRefresh()}))}}},b=v,_=(a("2483"),a("2877")),y=Object(_["a"])(b,n,i,!1,null,null,null),w=y.exports,C=a("a1db");C["a"].init(w)},f443:function(t,e,a){}});
//# sourceMappingURL=my_fault.ab44cef1.js.map